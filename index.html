<!DOCTYPE html>
<html>

<head>
    <base target="_top">
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous" />
    <title>オートバックス報告ツール</title>
    <style type="text/css">
        body {
            margin-left: 10px;
            margin-right: 10px;
            padding-bottom: 100px;
            font-size: 18px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .form-control {
            font-size: 16px;
        }

        h2 {
            font-weight: bolder;
            margin-bottom: 30px;
            padding: 5px;
            background-color: lightskyblue;
            color: darkblue;
        }

        h3 {
            border-bottom: solid skyblue 2px;
            border-left: solid skyblue 15px;
            font-weight: bold;
            padding: 5px;
            margin-top: 20px;
            color: black;
        }

        h4 {
            font-size: medium;
            margin-top: 10px;
            border-bottom: solid orange 1px;
        }

        .alert {
            margin: 5px;
        }

        .g1 {
            margin-bottom: 20px;
            padding: 5px;
        }

        .row {
            padding: 5px;
        }

        .form-control-file {
            font-size: small;
            padding: 5px;
            background-color: lightyellow;
            border-bottom: solid gray 2px;
            border-right: solid gray 2px;
        }

        .form-control {
            padding-left: 10px;
            margin-bottom: 5px;
        }

        .form-group {
            font-size: 18px;
            font-weight: bold;
            padding-top: 5px;
            padding-left: 30px;
            margin: 15px;
        }

        .btn-block {
            margin-top: 20px;
            margin-bottom: 50px;
            font-weight: bold;
        }

        .center {
            text-align: center;
        }

        #output {
            text-align: center;
            margin: 10px;
            font-weight: 500;
        }
    </style>
    <script>

    </script>
</head>

<body>
    <div class="text-center"><br><img src="https://www.gig.co.jp/wp/wp-content/themes/gigworks/images/main_message.png"
            height="80"><br></div><br>
    <h2 class="text-center">作業員証発行リクエスト</h2>
    <div class="alert alert-primary" role="alert">
        送信と同時に担当者及びシステム管理者に通知されます。<br />
        送信内容を間違えた場合は速やかにギグワークスへご連絡ください。
    </div>
    <div class="alert alert-info" role="alert">
        この発行リクエストは「原則１度のみ」です。<br />
        有効期限超過後は、個別にギグワークスへご連絡ください。<br />
    </div>
    <form id="myForm" onsubmit="handleFormSubmit(this)">
        <div class="g1 rounded">
            <h3>エージェントID</h3>
            <input type="text" class="form-control" name="agid" placeholder="エージェントID" required>
            <h3>フルネーム（漢字）</h3>
            <input type="text" class="form-control" name="name" placeholder="フルネーム" required>
            <h3>フルネーム（ふりがな）</h3>
            <input type="text" class="form-control" name="mean" placeholder="ふりがな" required>
            <h3>作業員証送付先メールアドレス</h3>
            <input type="email" class="form-control" name="mailaddress" placeholder="hogehoge@hoge.com" required>
        </div>
        <div class="g1 rounded">
            <h3>作業員証に埋め込む写真</h3>
            <div class="alert alert-danger mt-3 p-1" role="alert">
                <div class="badge bg-white text-danger">写真の基準を確認してください</div><br />
                ・帽子/過度なヘアスタイリング/眼が隠れるヘアスタイルは禁止です<br />
                ・顔の中央（鼻～眉間）が画像の中心にありますか？<br />
                ・背景は無地（白/グレー）<br />
                ・業務にふさわしい服装ですか？<br />
                ・顔が識別できる適切な明るさの画像ですか？<br />
                ・トリミング以外の画像加工/補正はおこなっていませんか？<br />
                ・直近２週間程度で撮影したあなた本人の画像ですか？<br />
                ・４:３のポートレートサイズ（縦構図）で撮影してください<br />
                　見本：<a href="https://www.nikon-image.com/enjoy/phototech/cameralesson/lesson14.html">ニコン公式サイト</a>
            </div>
            <div class="row">
                <div class="col-sm">
                    <input class="form-control-file" id="img" name="img" type="file" accept="image/*" required />
                </div>
                <div class="col-sm"><img id="report01_prv" class="img-thumbnail" /></div>
            </div>
        </div>
        <div id="output"></div>
        <input type="submit" id="submit_btn" value="上記内容で作業員証をリクエスト" class="btn btn-warning btn-lg btn-block" />
    </form>
    <div class="center"><a id="driveUrl" href="" target="_blank"></a></div>

    <br><br><br><br><br><br><br>
</body>
<script>
    // Prevent forms from submitting.
    function preventFormSubmit() {
        var forms = document.querySelectorAll('form');
        for (var i = 0; i < forms.length; i++) {
            forms[i].addEventListener('submit', function (event) {
                event.preventDefault();
            });
        }
    }
    window.addEventListener('load', preventFormSubmit);
    const div = document.getElementById('output');
    const urllink = document.getElementById('driveUrl');
    const btn = document.getElementById('submit_btn');


    /////////////////////////////////////////////////////////////
    function handleFormSubmit(formObject) {
        document.getElementById("submit_btn").disabled = true;

        var res = confirm('アップロードを実行しますか？');
        if (res != true) {
            alert('再度確認して実行してください');
            div.innerHTML = '中断しました';
            document.getElementById("submit_btn").disabled = false;
        } else {

            div.innerHTML = '送信しています。しばらくお待ちください。<br>（環境によっては30秒ほどかかる場合があります）';
            try {
                google.script.run.withSuccessHandler(update).withFailureHandler(fail).withUserObject(this).formRequest(formObject);
                btn.value = 'ロックしました';
            } catch (e) {
                fail();
                div.innerHTML = e;
            }

        }
    }

    function update(respons) {
        alert('送信完了。\nありがとうございます。');
    }
    function fail(e) {
        //div.innerHTML = '!!! < ERROR : UPLOAD FAILURE > !!!';
        document.getElementById("submit_btn").disabled = false;
        btn.value = '再送';
        div.innerHTML = e;
        alert('送信に失敗しました。\nお手数ですが再度送信してください。');
    }



    /* report_img */
    document
        .getElementById("img")
        .addEventListener("change", function (e1) {
            var file1 = e1.target.files[0]
            var blobUrl1 = window.URL.createObjectURL(file1)
            var img1 = document.getElementById("report01_prv")
            img1.src = blobUrl1
        })
</script>

</html>



{
    replyTo: "",
    name: "",
    bcc: "",
    cc: "",
    noReply: true
}
